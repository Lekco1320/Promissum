<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ctrl="clr-namespace:Lekco.Wpf.Control">

    <Style TargetType="{x:Type ctrl:DateTimePicker}">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ctrl:DateTimePicker}">

                    <Grid>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="125" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="0"
                                 IsReadOnly="True"
                                 Text="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" />

                        <ctrl:IconToggleButton Grid.Column="1"
                                               VerticalAlignment="Center"
                                               IconData="M9,10H7V12H9V10M13,10H11V12H13V10M17,10H15V12H17V10M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V8H19V19Z"
                                               IsChecked="{Binding IsOpen, ElementName=Popup}" />

                        <Popup x:Name="Popup"
                               Grid.ColumnSpan="2"
                               AllowsTransparency="True"
                               Focusable="False"
                               Placement="Bottom"
                               PopupAnimation="Fade"
                               VerticalOffset="3">

                            <Border Background="{DynamicResource CWhiteBrush}"
                                    BorderBrush="{DynamicResource CGrayBrush}"
                                    BorderThickness="1"
                                    CornerRadius="3"
                                    SnapsToDevicePixels="True">

                                <StackPanel Orientation="Vertical">

                                    <Calendar BorderThickness="0"
                                              SelectedDate="{Binding SelectedDate, RelativeSource={RelativeSource TemplatedParent}}" />

                                    <Border Width="{TemplateBinding Width}"
                                            BorderBrush="{DynamicResource CGrayBrush}"
                                            BorderThickness="0,1,0,0" />

                                    <Grid Margin="2,6">

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <ctrl:NumericUpDown Grid.Column="0"
                                                            HorizontalContentAlignment="Center"
                                                            Maximum="23"
                                                            Value="{Binding Hour, RelativeSource={RelativeSource TemplatedParent}}" />

                                        <TextBlock Grid.Column="1"
                                                   Margin="2,0"
                                                   Text=":" />

                                        <ctrl:NumericUpDown Grid.Column="2"
                                                            HorizontalContentAlignment="Center"
                                                            Maximum="59"
                                                            Value="{Binding Minute, RelativeSource={RelativeSource TemplatedParent}}" />

                                        <TextBlock Grid.Column="3"
                                                   Margin="2,0"
                                                   Text=":" />

                                        <ctrl:NumericUpDown Grid.Column="4"
                                                            HorizontalContentAlignment="Center"
                                                            Maximum="59"
                                                            Value="{Binding Second, RelativeSource={RelativeSource TemplatedParent}}" />

                                    </Grid>

                                </StackPanel>

                                <Border.Effect>

                                    <DropShadowEffect BlurRadius="3"
                                                      Direction="315"
                                                      Opacity="0.15"
                                                      ShadowDepth="2.5"
                                                      Color="{DynamicResource CBlack}" />

                                </Border.Effect>

                            </Border>

                        </Popup>

                    </Grid>

                </ControlTemplate>
            </Setter.Value>
        </Setter>

    </Style>

</ResourceDictionary>